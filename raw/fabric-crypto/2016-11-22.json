[
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "Hey, anyone here for a *really* *really* quick (yet urgent) question?",
        "edited": {
            "user": "U0ZJZBJLF",
            "ts": "1479827846.000000"
        },
        "ts": "1479827836.002413"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "<@U26T99AQ4> , <@U0ZR63HLK> <@U1BC5A0F9>  ?",
        "ts": "1479827926.002415"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "go ahead",
        "ts": "1479827995.002416"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "thanks",
        "ts": "1479828055.002417"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "it's about multi-channel support",
        "ts": "1479828065.002418"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "let's say I have a certificate of a peer",
        "ts": "1479828077.002419"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "can I know from that certificate, the certificate of the CA of that org?",
        "ts": "1479828091.002420"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "or if I can ask in a different way- what can I extract from the peer's certificate about the org's CA?",
        "ts": "1479828121.002421"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "The reason I'm asking is of course- I need to do filtering and to only send messages of a certain kind to peers that are in the organizations of the channel",
        "ts": "1479828155.002422"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "(end of question:writing_hand: )",
        "ts": "1479828742.002423"
    },
    {
        "type": "message",
        "user": "U0XQ35CDD",
        "text": "Isn't it a cert chain that you have?",
        "ts": "1479829048.002424"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "How would you define a filtering?",
        "ts": "1479829055.002425"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "meaning filtering among certificates you already have?",
        "ts": "1479829065.002426"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "No, I mean- let's say I'm a peer `p` in org A and I know that this message I have in my hands can only be sent to orgs A, B and C",
        "edited": {
            "user": "U0ZJZBJLF",
            "ts": "1479829134.000000"
        },
        "ts": "1479829106.002427"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "right but atthe moment you do not know an implemented broadcast mechanism",
        "ts": "1479829128.002428"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "\"an implemented broadcast mechanism\" - what's that?",
        "ts": "1479829150.002430"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "oh",
        "ts": "1479829158.002431"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "it has nothing to do with that",
        "ts": "1479829161.002432"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "the orderer type is irrelevant",
        "ts": "1479829169.002433"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "given an identity you can derive from there i) the mspid of the MSP that identity claim to belong to, and(ii) validity of that identity within that MSP",
        "ts": "1479829172.002434"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "Meaning that unless you have some sort of contact point for what you call organization A, assuming that thisis represented by an MSP",
        "ts": "1479829214.002435"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "you will not  be able to send a message to all members of A",
        "ts": "1479829226.002436"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "unless you have their contact information + certificate",
        "ts": "1479829236.002437"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "Why not?",
        "ts": "1479829239.002438"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "certificate = identity",
        "ts": "1479829243.002439"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "let me rephrase maybe that'll make things more clear:",
        "ts": "1479829253.002440"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "I'm a peer `p`  in org A and I have a message `m` that I know I can only send to orgs A, B,C, meaning- to *any* peer in orgs A, B and C.\nnow comes peer `q`, can  I determine whether `q` is in orgs A, B or C? or not?",
        "edited": {
            "user": "U0ZJZBJLF",
            "ts": "1479829345.000000"
        },
        "ts": "1479829295.002441"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "ah fine",
        "ts": "1479829344.002445"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "this would be possible using the orgA MSP",
        "ts": "1479829366.002447"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "that is in that chain's description",
        "ts": "1479829379.002448"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "orgA's MSP is \"identical\"\\equivalent to all peers in org A or something?",
        "edited": {
            "user": "U0ZJZBJLF",
            "ts": "1479829408.000000"
        },
        "ts": "1479829395.002449"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "so in each chain we would have a description of the MSPs there in. Ideally there is one MSP per organization",
        "ts": "1479829406.002450"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "MSP = membership service provider",
        "ts": "1479829427.002452"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "in its simpler form consists of a CA",
        "ts": "1479829434.002453"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "yeah I know the acronym but it's also a library name",
        "ts": "1479829443.002454"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "root CA, and certificates of members of that MSP are signed with that root CA's signing key",
        "ts": "1479829452.002455"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "at the chain creation ntime, the MSPManager that is fed the genesis block would instantiate the MSPs described in the genesis block",
        "ts": "1479829480.002456"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "when you say instantiate the MSPs you mean, instantiate the MSPs of each peer in the channel, right?",
        "ts": "1479829515.002457"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "at the chain creation, MSP defintiion is accompanied by the id of that MSP, so that identities can reference it and be parsed\/evaluated with that MSP",
        "ts": "1479829515.002458"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "so the peer gets the genesis block",
        "ts": "1479829537.002459"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "reads the MSPs included there and asks the chain's MSPManager to create one or more MSP objects as described in the genesis block.",
        "ts": "1479829569.002460"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "Using that , the peer can check if a given certificate\/identity is a valid identity within the presmise of an MSP",
        "ts": "1479829592.002461"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "so if you have multiple organizations in side the same MSP then you can use the OU inside the certificate for finer grained determination of the org a cert  belongs to",
        "ts": "1479829638.002462"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "OU is equivalent to an organization I presume?",
        "ts": "1479829702.002463"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "organization unit",
        "ts": "1479829819.002464"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "could be yes",
        "ts": "1479829828.002465"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "and if I may be more precise and get to the bottom line- can the MSP (as a component of a peer) give me the following ability:\n`OrgByPeerIdentity(PeerIdentityType) OrgIdentityType`",
        "ts": "1479829871.002466"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "Meaning- if I have a peer's certificate (what you guys call an identity) - can I derive from it the OU or anything that determines its organization, even if the peer is *from a different org*?",
        "ts": "1479829928.002467"
    },
    {
        "type": "message",
        "user": "U0PB67X4K",
        "text": "<@U0ZJZBJLF> - we most definitely need to have that capability",
        "ts": "1479830902.002468"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "yeah I'm just making a double check for: <https:\/\/gerrit.hyperledger.org\/r\/#\/c\/2705\/>",
        "ts": "1479830937.002469"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "I'm continuing multi-channel support in gossip this week and I suddenly remembered I haven't changed the already committed API to that phone call we had",
        "ts": "1479830972.002470"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "so I want to make sure this is OK, and then I'll rebase the branch to this branch",
        "ts": "1479830987.002471"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "(I'll end up again with a chain of commits, like I always do lately :slightly_smiling_face: )",
        "ts": "1479831002.002472"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "So I wanted to ensure *they*'re OK with it",
        "ts": "1479831038.002473"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "mhh, we don't have right now this concept of organization. An MSP instance can represent an organization as Elli was saying. Not sure if this is enough to cover all the cases. Otherwise we have to pretend that MSPs based on different technologies have to support this concept, this might be fine.",
        "ts": "1479832299.002474"
    },
    {
        "type": "message",
        "user": "U0PB67X4K",
        "text": "<@U0ZR63HLK> - now that we have a basic end to end path working, we need to step back and quickly revisit the whole MSP implementation.  This is unfortunate but not unexpected.",
        "ts": "1479832994.002475"
    },
    {
        "type": "message",
        "user": "U0PB67X4K",
        "text": "but for sure we need a way to extract \"organization\" from identities \/ certificates",
        "ts": "1479833038.002476"
    },
    {
        "type": "message",
        "user": "U0PB67X4K",
        "text": "gossip, vscc and orderer (for config) all need this",
        "ts": "1479833090.002477"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "<@U0PB67X4K>, by organization, do you mean MSP_ID?",
        "ts": "1479833310.002478"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "wait wait <@U0ZR63HLK>  this doesn't make sense that you don't have an org-equivalent entity. \nHow do you do filtering of which peers are allowed to call `Deliver` on a specific channel? From Elli's google doc I inferred that the ordering service consults the MSP to decide that, and that MSP decides on the org to which the peer belongs to",
        "ts": "1479833410.002479"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "I mean, we don't have an org concept exposed by the MSP, the only think close to it can be the MSP_ID",
        "ts": "1479833491.002480"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "for instance, if you look at this file configuration file: <https:\/\/gerrit.hyperledger.org\/r\/#\/c\/2677\/1\/config-files\/peer-init-config.json>",
        "ts": "1479833541.002481"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "there is a _comment_cert-validation-policy section",
        "ts": "1479833557.002482"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "that says what it means for an identity to belong to a specific MSP",
        "ts": "1479833579.002483"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "I might be wrong, let's have also Elli validating this",
        "edited": {
            "user": "U0ZR63HLK",
            "ts": "1479833615.000000"
        },
        "ts": "1479833600.002484"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "You mean the principals?",
        "ts": "1479833768.002486"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "Ok but certificates\/identities contain both information",
        "ts": "1479834892.002487"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "the organization (as standard x509 certificates) and the MSPID of the MSP they refer to",
        "ts": "1479834910.002488"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "I've lost the context you're replying to, Elli",
        "ts": "1479834933.002489"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "Ok, an MSP aims to represent some group of certificates. Ideally this should be connected to one or more organizations.",
        "ts": "1479834960.002490"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "This would be reflected to the root certificates included in that MSP validation path. To get the specific organization an identity belongs to, the identity is already equipped with a function to return that identity's organization within that MSP.",
        "ts": "1479835025.002491"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "What's the name of the function?",
        "ts": "1479835057.002492"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "getParticipant() I believ",
        "ts": "1479835071.002493"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "e",
        "ts": "1479835071.002494"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "or getParticipantID()",
        "ts": "1479835081.002495"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "but from a security perspective it is important",
        "ts": "1479835106.002496"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "that it is always considered within the msp this identity belongs to",
        "ts": "1479835116.002497"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "And what's the output of that function?",
        "ts": "1479835135.002498"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "otherwise malicious MSPs can issue certificates on organizations they do not own\/control.",
        "ts": "1479835137.002499"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "identity.getParticipantID()",
        "ts": "1479835150.002500"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "no input",
        "ts": "1479835152.002501"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "identity represents the certificate",
        "ts": "1479835164.002502"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "I mean, for the x509 based implementation of the MSP, what's the output of that function?",
        "ts": "1479835205.002503"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "th ou of that identity",
        "ts": "1479835213.002504"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "certificate",
        "ts": "1479835218.002505"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "Okay, I was mislead by the name. Got it! ",
        "ts": "1479835289.002506"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "yeah, well we need to finalize the terminology",
        "ts": "1479835399.002507"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "Okay, so we can say that what <@U0ZJZBJLF>  requires is offered by the MSP",
        "ts": "1479835474.002508",
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U0ZJZBJLF"
                ],
                "count": 1
            }
        ]
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "cause participant somehow at some point meant to represent an organization which was supposed to be represented by an MSP",
        "ts": "1479835516.002509"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": "correct",
        "ts": "1479835517.002510"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "So, the method `OrgByPeerIdentity(PeerIdentityType) OrgIdentityType`\nIn: <https:\/\/gerrit.hyperledger.org\/r\/#\/c\/2705\/4\/gossip\/api\/channel.go> \nIs something that each peer can have and invoke on an identity of any other peer, right? <@U0ZR63HLK> , <@U1BC5A0F9>  ?",
        "edited": {
            "user": "U0ZJZBJLF",
            "ts": "1479835687.000000"
        },
        "ts": "1479835664.002511"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "The answer should be yes at this point :) ",
        "edited": {
            "user": "U0ZR63HLK",
            "ts": "1479836459.000000"
        },
        "ts": "1479836032.002513"
    },
    {
        "type": "message",
        "user": "U0ZJZBJLF",
        "text": "\"at this point\" is what I fear the most in this project, but that's much better than nothing. \nThanks :slightly_smiling_face:",
        "ts": "1479836078.002514"
    },
    {
        "type": "message",
        "user": "U0ZR63HLK",
        "text": "Right :)",
        "ts": "1479836117.002515"
    },
    {
        "type": "message",
        "user": "U1BC5A0F9",
        "text": ":slightly_smiling_face:",
        "ts": "1479839399.002518"
    }
]